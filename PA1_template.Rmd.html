<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="generator" content="litedown 0.7">
<title>Rep_data_PeerAssessment1</title>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  print-color-adjust: exact;
  -webkit-print-color-adjust: exact;
}
body, .abstract, code, .footnotes, footer, #refs, .caption { font-size: .9em; }
li li { font-size: .95em; }
ul:has(li > input[type="checkbox"]) { list-style: none; padding-left: 1em; }
*, :before, :after { box-sizing: border-box; }
a { color: steelblue; }
pre, img { max-width: 100%; }
pre { white-space: pre-wrap; word-break: break-word; }
pre code { display: block; padding: 1em; overflow-x: auto; }
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre, th) > code, code[class], div > .caption { background: #f8f8f8; }
pre > code:is(:not([class]), .language-plain, .language-none, .plain), .box, .figure, .table { background: inherit; border: 1px solid #eee; }
pre > code {
  &.message { border-color: #9eeaf9; }
  &.warning { background: #fff3cd; border-color: #fff3cd; }
  &.error { background: #f8d7da; border-color: #f8d7da; }
}
.fenced-chunk { border-left: 1px solid #666; }
.code-fence {
  opacity: .4;
  border: 1px dashed #666;
  border-left: 2px solid;
  &:hover { opacity: inherit; }
}
.box, .figure, .table, table { margin: 1em auto; }
div > .caption { padding: 1px 1em; }
.figure { p:has(img, svg), pre:has(svg) { text-align: center; } }
.flex-col { display: flex; justify-content: space-between; }
table {
  &:only-child:not(.table > *) { margin: auto; }
  th, td { padding: 5px; font-variant-numeric: tabular-nums; }
  thead, tfoot, tr:nth-child(even) { background: whitesmoke; }
  thead th { border-bottom: 1px solid #ddd; }
  &:not(.datatable-table) {
    border-top: 1px solid #666;
    border-bottom: 1px solid #666;
  }
}
blockquote {
  color: #666;
  margin: 0;
  padding: 1px 1em;
  border-left: .5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC {
  a { text-decoration: none; }
  ul { list-style: none; padding-left: 1em; }
  & > ul { padding: 0; }
  ul ul { border-left: 1px solid lightsteelblue; }
}
.body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.main-number::after { content: "."; }
span[class^="ref-number-"] { font-weight: bold; }
.ref-number-fig::after, .ref-number-tab::after { content: ":"; }
.cross-ref-chp::before { content: "Chapter "; }
.cross-ref-sec::before { content: "Section "; }
.cross-ref-fig::before, .ref-number-fig::before { content: "Figure "; }
.cross-ref-tab::before, .ref-number-tab::before { content: "Table "; }
.cross-ref-eqn::before, .MathJax_ref:has(mjx-mtext > mjx-c + mjx-c)::before { content: "Equation "; }
.abstract, #refs {
  &::before { display: block; margin: 1em auto; font-weight: bold; }
}
.abstract::before { content: "Abstract"; text-align: center; }
#refs::before { content: "Bibliography"; font-size: 1.5em; }
.ref-paren-open::before { content: "("; }
.ref-paren-close::after { content: ")"; }
.ref-semicolon::after { content: "; "; }
.ref-and::after { content: " and "; }
.ref-et-al::after { content: " et al."; font-style: italic; }
.footnote-ref a {
  &::before { content: "["; }
  &::after { content: "]"; }
}
section.footnotes {
  margin-top: 2em;
  &::before { content: ""; display: block; max-width: 20em; }
}
.fade {
  background: repeating-linear-gradient(135deg, white, white 30px, #ddd 32px, #ddd 32px);
  opacity: 0.6;
}

@media print {
  body { max-width: 100%; }
  tr, img { break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  body:not(.pagesjs) pre:has(.line-numbers):not(:hover) { white-space: pre; }
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xiee/utils@1.14.21/css/prism-xcode.min.css">
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
</head>
<body>
<div class="frontmatter">
<div class="title"><h1>Rep_data_PeerAssessment1</h1></div>
<div class="author"><h2>Cerys Williams</h2></div>
<div class="date"><h3>2025-12-16</h3></div>
</div>
<div class="body">
<h3 id="sec:upload-the-dataset">Upload the dataset</h3>
<p>I downloaded the data set to my working directory and then used read.csv to install the data set from there.</p>
<pre><code class="language-r">library(tidyverse)
</code></pre>
<pre><code>## Warning: package 'tidyverse' was built under R version 4.5.2
</code></pre>
<pre><code>## ── Attaching core tidyverse packages ─────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.6.0
## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
## ✔ purrr     1.2.0     
## ── Conflicts ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
</code></pre>
<pre><code class="language-r">activity &lt;- read_csv(&quot;activity.csv&quot;)
</code></pre>
<pre><code>## Rows: 17568 Columns: 3
## ── Column specification ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl  (2): steps, interval
## date (1): date
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
</code></pre>
<h3 id="sec:set-echo-true-as-global-default-to-ensure-it-is-always-used-in-each-code-chunk">Set echo = TRUE as global default to ensure it is always used in each code chunk.</h3>
<pre><code class="language-r">knitr::opts_chunk$set(echo = TRUE)
</code></pre>
<h3 id="sec:what-is-the-total-number-of-steps-taken-in-one-day">What is the total number of steps taken in one day?</h3>
<p>Step 1: Calculate the total number of steps take in one day.</p>
<pre><code class="language-r">daily_steps_total &lt;- activity %&gt;%
  group_by(date) %&gt;%
  summarise(sum_total_steps = sum(steps))
</code></pre>
<p>Step 2: Make a histogram of the total number of steps each day.</p>
<pre><code class="language-r">hist(daily_steps_total$sum_total_steps,
     main = &quot;Total number of steps per day&quot;,
     xlab = &quot;Number of Steps&quot;,
     ylab = &quot;Frequency&quot;,
     )
</code></pre>
<p>![plot of chunk histogram total number of steps per day](figure/histogram total number of steps per day-1.png)</p>
<p>Step 3: Calculate and report the mean and median of the total number of steps taken per day.
For this calculation dataframe I created in step 1 when I calculated the total number of steps in one day.</p>
<pre><code class="language-r">daily_steps_mean_median &lt;- daily_steps_total %&gt;%
  group_by(date) %&gt;%
  summarise(mean_total_steps = mean(sum_total_steps), median_total_steps = median(sum_total_steps))
</code></pre>
<h3 id="sec:what-is-the-average-daily-activity-pattern">What is the average daily activity pattern?</h3>
<p>Step 1: Create a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis). Ignoring the N/A in this case does not produce a valid response.</p>
<pre><code class="language-r">interval_mean &lt;- activity %&gt;%
  group_by(interval) %&gt;%
  summarise(interval_mean = mean(steps, na.rm = TRUE))

ggplot(interval_mean, aes(x = interval, y = interval_mean)) +
  geom_line(color = &quot;blue&quot;, lwd = 1) +
  labs(title = &quot;Daily Activity Pattern&quot;,
       x = &quot;Interval&quot;,
       y = &quot;Mean number of steps per interval&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
</code></pre>
<p>![plot of chunk interval mean](figure/interval mean-1.png)</p>
<p>Step 2: Calculate which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?  Ignoring the N/A in this case does not produce a valid response.  The max number of steps has been arranged in decreasing order so that calling the head function would identify the interval with the most steps. A  a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis) identifies the pattern.</p>
<pre><code class="language-r">interval_max &lt;- activity %&gt;%
  group_by(interval) %&gt;%
  summarise(max_steps = max(steps, na.rm = TRUE)) %&gt;%
  arrange(desc(max_steps))

head(interval_max)
</code></pre>
<pre><code>## # A tibble: 6 × 2
##   interval max_steps
##      &lt;dbl&gt;     &lt;dbl&gt;
## 1      615       806
## 2      900       802
## 3      550       794
## 4      720       789
## 5      835       786
## 6      925       785
</code></pre>
<pre><code class="language-r">ggplot(interval_max, aes(x = interval, y = max_steps)) +
  geom_line(color = &quot;blue&quot;, lwd = 1) +
  labs(title = &quot;Daily Activity Pattern&quot;,
       x = &quot;Interval&quot;,
       y = &quot;Max number of steps per interval&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
</code></pre>
<p>![plot of chunk interval max](figure/interval max-1.png)</p>
<h3 id="sec:imputing-missing-values">Imputing missing values</h3>
<p>Calculate the total number of NA in the activity data set.</p>
<pre><code class="language-r">colSums(is.na(activity))
</code></pre>
<pre><code>##    steps     date interval 
##     2304        0        0
</code></pre>
<p>A new dataset has been created where the  mean for that 5-minute interval in the day has been used to fill in all of the missing values.   The number of NA is is recalculated in the new dateset to make sure that none remain.</p>
<pre><code class="language-r">activity_imputed &lt;- activity %&gt;%
  group_by(interval) %&gt;%
  mutate(steps = ifelse(is.na(steps),
                        mean(steps, na.rm = TRUE),
                        steps))

colSums(is.na(activity_imputed))
</code></pre>
<pre><code>##    steps     date interval 
##        0        0        0
</code></pre>
<h3 id="sec:are-there-differences-in-activity-patterns-between-weekdays-and-weekends">Are there differences in activity patterns between weekdays and weekends?</h3>
<p>Used the weekdays() function to create a variable containing the 2 levels Weekday and weekend.</p>
<pre><code class="language-r">activity_imputed &lt;- activity_imputed %&gt;%
  mutate(date, weekdays(date)) %&gt;%
  mutate(weekdays = case_when(`weekdays(date)` %in% c(&quot;Saturday&quot;, &quot;Sunday&quot;) ~ &quot;Weekend&quot;,TRUE ~ &quot;Weekday&quot;))
</code></pre>
<p>Calculated the mean number of steps per interval, averaged across all weekday days or weekend days.  Use the data to create a panel plot  containing time series plots of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all weekday days or weekend days (y-axis) using ggplot2 and facet_wrap function.</p>
<pre><code class="language-r">activity_imputed_averaged &lt;- activity_imputed %&gt;%
  group_by(interval, weekdays) %&gt;%
  summarise(mean_steps = mean(steps))
</code></pre>
<pre><code>## `summarise()` has grouped output by 'interval'. You can override using the `.groups` argument.
</code></pre>
<pre><code class="language-r">ggplot(activity_imputed_averaged, aes(x = interval, y = mean_steps)) +
  geom_line(color = &quot;blue&quot;, lwd = 1) +
  facet_wrap(~ weekdays) +   
  labs(title = &quot;Weekday v Weekend Activity Pattern&quot;,
       x = &quot;Interval&quot;,
       y = &quot;Mean number of steps per interval&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
</code></pre>
<p>![plot of chunk compare weekday and weekend](figure/compare weekday and weekend-1.png)</p>
</div>
</body>
</html>
